---
title: "Delambre Island  Flatback Turtle Monitoring Report - Appendix 1: Data"
author: "NWSFTCP, DBCA"
date: "`r Sys.time()`"
output:
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
    fig_width: 10
    fig_height: 6
    code_folding: hide
    theme: lumen
vignette: >
  %\VignetteIndexEntry{wastd}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
params:
  area_name: 'Delambre Island'
editor_options: 
  markdown: 
    wrap: 72
---

```{css, echo=FALSE}
body, .main-container {max-width: 100%; margin-left: auto; margin-right: auto;}
```

```{r setup, message=FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>")
options(rmarkdown.html_vignette.check_title = FALSE)
library(wastdr)
drake::loadd("wastd_data")
rt <- . %>% 
  reactable::reactable(
    ., 
    filterable = T, 
    sortable = T, 
    searchable = T
  )
rt_wastd <- . %>% 
  reactable::reactable(
    ., 
    filterable = T, 
    sortable = T, 
    searchable = T,
    columns = list(wastd = reactable::colDef(html=TRUE))
  )

zipfn <- wastdr::urlize(params$area_name)
fn <- here::here("inst/reports/rio", zipfn)
if (!fs::file_exists(fn)) {
  "Creating dir {fn}" %>% glue::glue() %>% wastdr::wastdr_msg_info()
  fs::dir_create(fn, recurse = TRUE)
}

placename <- "Delambre"
prefix <- "DEL"

x <- wastd_data %>% 
  wastdr::filter_wastd_turtledata(area_name = params$area_name)
```

# Data
In this report, we present combined Turtle Monitoring data from WAStD and
filter the data to the location `r params$area_name`.

The data was downloaded from WAStD on `r wastd_data$downloaded_on` and reflects
all QA operations up to this date.

# Survey effort

```{r survey_effort}
x$surveys %>% 
  wastdr::survey_season_site_stats() %>% 
  gt::gt(
    groupname_col=NULL,
    caption = "Seasonal survey stats"
  ) %>% 
  gt::tab_header("Multi-season survey stats")

x$surveys %>%
      wastdr::surveys_per_site_name_and_date(.) %>%
      ggTimeSeries::ggplot_calendar_heatmap("turtle_date", "n") +
      ggplot2::scale_fill_binned(low = "green", high = "red", ) +
      ggplot2::facet_grid(rows = ggplot2::vars(Year)) +
      ggplot2::ggtitle(glue::glue("Survey effort at {placename}")) +
      ggplot2::xlab(NULL) + ggplot2::ylab(NULL) +
      ggplot2::theme_classic() 
```
# Nesting

## Total turtles per night

## Nesting females

## Processed vs missed
Proportion of processed vs missed turtles
* Time series: y=number, x=date, group=processed/missed
* Time series: y=proportion of processed, x=season

## Recaptured vs new

## Morphometrics

## Nesting success

## Hatching and emergence success

## Sand temperatures


# Connectivity


## Connections to foraging grounds
### Tag recoveries
Tags from Delambre rookery found elsewhere (individual)

### Satellite tracking

## Pressures and Threats
### Injuries of tagged turtles
### Predation and Disturbance

